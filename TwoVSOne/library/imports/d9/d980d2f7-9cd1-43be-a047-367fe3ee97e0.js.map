{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\chessinit.js"],"names":["Game","cc","Class","extends","Component","properties","chessPrefab","default","type","Prefab","occupied","occupiedcolor","gameState","lastNode","prepare","directionX","directionY","ctor","selectchess","event","chessList","distance","i","d","pDistance","v2","getLocationX","getLocationY","convertToWorldSpaceAR","push","min","minpos","j","sortchesss","game","theThree","sort","a","b","console","log","opacity","k","length","splice","eatchess","chessNode","count","flag","temp","s","parseInt","r","indexOf","chessinit","self","Node","y","x","newNode","instantiate","node","addChild","setPosition","p","width","height","setContentSize","on","EventType","MOUSE_DOWN","position","Math","max","alert","getComponent","Sprite","spriteFrame","SpriteFrame","url","raw","start"],"mappings":"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","file":"chessinit.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["var Game = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        chessPrefab: {//棋子的预制资源\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        occupied: {//记录当前棋盘中被占用的节点位置\r\n            default: []\r\n        },\r\n        occupiedcolor: {//记录当前棋盘中被占用的节点颜色 0：无子 1：白色 2：黑色\r\n            default: []\r\n        },\r\n        gameState: {// 游戏顺序\r\n            default: 'white'\r\n        },\r\n        lastNode: {// 上一步棋子位置\r\n            default: 0\r\n        },\r\n        prepare: {// 是否是准备走棋子 0：否 1：是\r\n            default: 0\r\n        },\r\n        directionX: {//X轴\r\n            default: []\r\n        },\r\n        directionY: {//Y轴\r\n            default: []\r\n        },\r\n    },\r\n    //构造函数\r\n    ctor: function () {\r\n        // 声明实例变量并赋默认值\r\n        this.occupied = [1, 2, 3, 4, 5, 21, 22, 23, 24, 25];\r\n        this.occupiedcolor = [0, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1];\r\n        this.directionX = [1, -1];\r\n        this.directionY = [5, -5];\r\n    },\r\n    //返回点击的棋子节点\r\n    selectchess(event, chessList) {\r\n        var distance = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            //计算鼠标点击位置和各棋子节点之间的距离\r\n            //将棋子节点的坐标转化为世界坐标系\r\n            var d = cc.pDistance(cc.v2(event.getLocationX(), event.getLocationY()), chessList[i + 1].convertToWorldSpaceAR(cc.v2(0, 0)));\r\n            distance.push(d);\r\n        };\r\n        var min = distance[0];\r\n        var minpos = 0;\r\n        //取距离最近的下标，即棋子节点位置\r\n        for (var j = 1; j < 25; j++) {\r\n            if (distance[j] < min) {\r\n                min = distance[j]\r\n                minpos = j;\r\n            }\r\n        }\r\n\r\n        return minpos;\r\n    },\r\n    //重新排序连续的三个棋子并判断哪个被吃掉 在eatchess()中被调用\r\n    sortchesss(game,chessList,theThree) {\r\n        theThree = theThree.sort(function (a, b) { return a - b; });//实现数组中按照数字大小排序\r\n        console.log('theThreeX:' + theThree);\r\n        if (game.occupiedcolor[theThree[0]] == game.occupiedcolor[theThree[1]]) {\r\n            if (game.occupiedcolor[theThree[1]] != game.occupiedcolor[theThree[2]]) {\r\n                chessList[theThree[2]].opacity = 0;\r\n                game.occupiedcolor[theThree[2]] = 0;\r\n                for (var k = 0; k < game.occupied.length; k++) {\r\n                    if (game.occupied[k] == theThree[2]) {\r\n                        game.occupied.splice(k, 1);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (game.occupiedcolor[theThree[1]] == game.occupiedcolor[theThree[2]]) {\r\n                chessList[theThree[0]].opacity = 0;\r\n                game.occupiedcolor[theThree[0]] = 0;\r\n                for (var k = 0; k < game.occupied.length; k++) {\r\n                    if (game.occupied[k] == theThree[0]) {\r\n                        game.occupied.splice(k, 1);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //判断是否吃子 在主程序中调用\r\n    eatchess(chessNode, game, chessList) {\r\n        var count = 1;\r\n        var flag = true;\r\n        var temp = chessNode;\r\n        var s = parseInt((chessNode - 1) / 5);//取除数用于判断x轴棋子所在范围\r\n        var r = (chessNode % 5 == 0) ? 5 : chessNode % 5;//取余数用于判断y轴棋子所在范围\r\n        console.log(game.occupied);\r\n        console.log(temp + ' ' + s + ' ' + r);\r\n        //X轴 j=0 X右侧；j=1 X左侧\r\n        for (var j = 0; j < 2; j++) {\r\n            //flag = true;\r\n            temp = temp + game.directionX[j];\r\n            while (temp > s * 5 && temp <= (s + 1) * 5) {\r\n                console.log('temp:' + temp);\r\n                if (game.occupied.indexOf(temp) != -1) {\r\n                    count++;\r\n                    temp = temp + game.directionX[j];\r\n                    console.log('countX:' + count);\r\n                } else {\r\n                    temp = temp + game.directionX[j];\r\n                }\r\n            }\r\n            temp = chessNode;\r\n        }\r\n        console.log('count:' + count);\r\n        if (count == 3) {//判断这三个棋子是否连续\r\n            var theThree = [];\r\n            count = 1;\r\n            temp = chessNode;\r\n            flag = true;\r\n            theThree.push(temp);\r\n            for (var j = 0; j < 2; j++) {\r\n                temp = temp + game.directionX[j];\r\n                flag = true;\r\n                while (flag && temp > s * 5 && temp <= (s + 1) * 5) {\r\n\r\n                    if (game.occupied.indexOf(temp) != -1) {\r\n                        theThree.push(temp);\r\n                        count++;\r\n                        temp = temp + game.directionX[j];\r\n                    } else {\r\n                        flag = false;\r\n                    }\r\n                }\r\n                temp = chessNode;\r\n            }\r\n            console.log('count3y:' + count);\r\n            if (count == 3) {//重新排列这三个连续的棋子，将颜色不同的那个吃掉\r\n                game.sortchesss(game,chessList,theThree);\r\n            }\r\n        }\r\n        count = 1;\r\n        temp = chessNode;\r\n        //y轴 j=0 y右侧；j=1 y左侧\r\n        for (var j = 0; j < 2; j++) {\r\n            //flag = true;\r\n            while (temp >= r && temp <= 20 + r) {\r\n                temp = temp + game.directionY[j];\r\n                if (game.occupied.indexOf(temp) != -1) {\r\n                    count++;\r\n                    //console.log('countY:' + count);\r\n                } else {\r\n                    //flag = false;\r\n                }\r\n            }\r\n            temp = chessNode;\r\n        }\r\n        console.log('county:' + count);\r\n        if (count == 3) {//判断这三个棋子是否连续\r\n            var theThree = [];\r\n            count = 1;\r\n            temp = chessNode;\r\n            flag = true;\r\n            theThree.push(temp);\r\n            for (var j = 0; j < 2; j++) {\r\n                flag = true;\r\n                while (flag && temp >= r && temp <= 20 + r) {\r\n                    temp = temp + game.directionY[j];\r\n                    if (game.occupied.indexOf(temp) != -1) {\r\n                        theThree.push(temp);\r\n                        count++;\r\n                    } else {\r\n                        flag = false;\r\n                    }\r\n                }\r\n                temp = chessNode;\r\n            }\r\n            if (count == 3) {//重新排列这三个连续的棋子，将颜色不同的那个吃掉\r\n                game.sortchesss(game,chessList,theThree);\r\n            }\r\n        }\r\n    },\r\n    chessinit() {\r\n        var self = this;\r\n        var chessList = [cc.Node];//棋子从下标1开始           \r\n        for (var y = 0; y < 5; y++) {\r\n            for (var x = 0; x < 5; x++) {\r\n                var newNode = cc.instantiate(this.chessPrefab);//复制Chess预制资源\r\n                //为了调用类里面的静态方法，需要将类实例化\r\n                var game = new Game();\r\n                this.node.addChild(newNode);\r\n                newNode.setPosition(cc.p(x * (this.node.width / 4), y * (this.node.height / 4)));//根据棋盘和棋子大小计算使每个棋子节点位于指定位置\r\n                newNode.setContentSize(this.node.width / 6, this.node.height / 6);\r\n                newNode.opacity = 0;\r\n                chessList.push(newNode);\r\n                newNode.on(cc.Node.EventType.MOUSE_DOWN, function (event) {\r\n                    console.log(game.gameState);\r\n                    //显示此棋子节点 节点从1开始 所以需要+1\r\n                    var chessNode = game.selectchess(event, chessList) + 1;\r\n                    if (game.occupied.indexOf(chessNode) == -1) {\r\n                        game.occupied.push(chessNode);\r\n                    }\r\n                    //console.log(game.occupied);\r\n                    //点击棋子变为半透明状态\r\n                    if (chessList[chessNode].opacity != 0) {\r\n                        chessList[chessNode].opacity = 128;\r\n                        game.prepare = 1;\r\n                        game.lastNode = chessNode;\r\n                    } else {\r\n                        if (game.prepare == 1) {\r\n                            if (game.lastNode != 0) {//判断不能跨棋子移动\r\n                                if (chessList[chessNode].position.x == chessList[game.lastNode].position.x) {\r\n                                    var min = Math.min(chessNode, game.lastNode) + 5;\r\n                                    var max = Math.max(chessNode, game.lastNode);\r\n                                    for (var i = min; i < max; i = i + 5) {\r\n                                        if (game.occupied.indexOf(i) != -1) {\r\n                                            alert(\"不能跨越其他棋子！\");\r\n                                            chessList[game.lastNode].opacity = 255;\r\n                                            return false;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (chessList[chessNode].position.y == chessList[game.lastNode].position.y) {\r\n                                    var min = Math.min(chessNode, game.lastNode) + 1;\r\n                                    var max = Math.max(chessNode, game.lastNode);\r\n                                    for (var i = min; i < max; i++) {\r\n                                        if (game.occupied.indexOf(i) != -1) {\r\n                                            alert(\"不能跨越其他棋子！\");\r\n                                            chessList[game.lastNode].opacity = 255;\r\n                                            return false;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (chessList[chessNode].position.x != chessList[game.lastNode].position.x && chessList[chessNode].position.y != chessList[game.lastNode].position.y) {\r\n                                    alert(\"不能沿斜线移动棋子！\");\r\n                                    return false;\r\n                                }\r\n                            }\r\n                            //目标棋子节点显示，上一棋子节点透明\r\n                            if (game.gameState == 'white') {\r\n                                chessList[chessNode].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(cc.url.raw('resources/whitechess.png'));\r\n                                chessList[chessNode].opacity = 255;\r\n                                chessList[game.lastNode].opacity = 0;\r\n                                game.occupiedcolor[chessNode] = 1;\r\n                                //console.log(game.lastNode);\r\n                                //将颜色列表中上一棋子颜色改为0\r\n                                game.occupiedcolor[game.lastNode] = 0;\r\n                                //将上一棋子节点从occupied中删除\r\n                                for (var k = 0; k < game.occupied.length; k++) {\r\n                                    if (game.occupied[k] == game.lastNode) {\r\n                                        game.occupied.splice(k, 1);\r\n                                    }\r\n                                }\r\n                                game.prepare = 0;\r\n                                console.log(game.occupiedcolor);\r\n                                //判断吃子\r\n                                game.eatchess(chessNode, game, chessList);\r\n                                game.gameState = 'black';\r\n\r\n\r\n                            } else {\r\n                                chessList[chessNode].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(cc.url.raw('resources/blackchess.png'));\r\n                                chessList[chessNode].opacity = 255;\r\n                                chessList[game.lastNode].opacity = 0;\r\n                                game.occupiedcolor[chessNode] = 2;\r\n                                game.occupiedcolor[game.lastNode] = 0;\r\n                                for (var k = 0; k < game.occupied.length; k++) {\r\n                                    if (game.occupied[k] == game.lastNode) {\r\n                                        game.occupied.splice(k, 1);\r\n                                    }\r\n                                }\r\n                                game.prepare = 0;\r\n                                //判断吃子\r\n                                game.eatchess(chessNode, game, chessList);\r\n                                game.gameState = 'white';\r\n                            }\r\n                        }\r\n\r\n                    }\r\n                });\r\n            };\r\n        };\r\n        //初始化棋盘\r\n        for (var i = 0; i < 5; i++) {\r\n            chessList[i + 1].opacity = 255;\r\n            chessList[25 - i].opacity = 255;\r\n            chessList[25 - i].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(cc.url.raw('resources/whitechess.png'));\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        this.chessinit();\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}